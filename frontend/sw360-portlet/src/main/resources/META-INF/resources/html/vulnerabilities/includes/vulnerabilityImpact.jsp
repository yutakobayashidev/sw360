<%--
  ~ Copyright TOSHIBA CORPORATION, 2022. Part of the SW360 Portal Project.
  ~ Copyright Toshiba Software Development (Vietnam) Co., Ltd., 2022. Part of the SW360 Portal Project.
  ~
  ~ This program and the accompanying materials are made
  ~ available under the terms of the Eclipse Public License 2.0
  ~ which is available at https://www.eclipse.org/legal/epl-2.0/
  ~
  ~ SPDX-License-Identifier: EPL-2.0
  --%>
<%@ page import="javax.portlet.PortletRequest" %>
<%@ page import="com.liferay.portal.kernel.portlet.PortletURLFactoryUtil" %>
<%@ page import="com.liferay.portal.kernel.util.PortalUtil" %>
<%@ page import="org.eclipse.sw360.datahandler.thrift.vulnerabilities.Vulnerability" %>

<table id="vulnerabilityImpact" class="table edit-table three-columns">
    <thead>
        <tr>
            <th colspan="3"><liferay-ui:message key="vulnerability.impact" /></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <div class="form-group">
                    <input id="impactAvailabilityKey" readonly type="text"  class="form-control" value="availability" name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_KEY%>" />
                </div>
            </td>
            <td>
                <select class="form-control" name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_VALUE%>"  >
                    <option value=""> <liferay-ui:message key="select.impact.availability" /> </option>
                    <core_rt:forEach items="${vulnerabilityImpacts}" var="vulnerabilityImpact">
                        <core_rt:if test = "${vulnerabilityImpact == vulnerability.impact['availability']}">
                             <option value="${vulnerabilityImpact}" selected> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                        <core_rt:if test = "${vulnerabilityImpact != vulnerability.impact['availability']}">
                            <option value="${vulnerabilityImpact}"> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                    </core_rt:forEach>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <div class="form-group">
                    <input id="impactConfidentialityKey" readonly type="text"  class="form-control" value="confidentiality"
                        name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_KEY%>" />
                </div>
            </td>
            <td>
                <select class="form-control" name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_VALUE%>" >
                    <option value=""> <liferay-ui:message key="select.impact.confidentiality" /> </option>
                    <core_rt:forEach items="${vulnerabilityImpacts}" var="vulnerabilityImpact">
                        <core_rt:if test = "${vulnerabilityImpact == vulnerability.impact['confidentiality']}">
                             <option value="${vulnerabilityImpact}" selected> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                        <core_rt:if test = "${vulnerabilityImpact != vulnerability.impact['confidentiality']}">
                            <option value="${vulnerabilityImpact}"> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                    </core_rt:forEach>
                </select>
            </td>
        </tr>
        <tr>
            <td>
                <div class="form-group">
                    <input id="impactIntegrityKey" readonly type="text"  class="form-control" value="integrity"
                            name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_KEY%>" />
                </div>
            </td>
            <td>
                <select class="form-control" name="<portlet:namespace/><%=PortalConstants.VULNERABILITY_IMPACT_VALUE%>" >
                    <option value=""> <liferay-ui:message key="select.impact.integrity" /> </option>
                    <core_rt:forEach items="${vulnerabilityImpacts}" var="vulnerabilityImpact">
                        <core_rt:if test = "${vulnerabilityImpact == vulnerability.impact['integrity']}">
                             <option value="${vulnerabilityImpact}" selected> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                        <core_rt:if test = "${vulnerabilityImpact != vulnerability.impact['integrity']}">
                            <option value="${vulnerabilityImpact}"> <sw360:out value="${vulnerabilityImpact}"/> </option>
                        </core_rt:if>
                    </core_rt:forEach>
                </select>
            </td>
        </tr>
    </tbody>
</table>
